#!/bin/bash

echo "ğŸ§ª Testing Fixed Business Case Creation Flow..."
echo ""

echo "âœ… Service Status:"
echo "- Backend Health: $(curl -s http://localhost:8000/health)"
echo "- Frontend: $(curl -s -o /dev/null -w "%{http_code}" http://localhost:4000)"

echo ""
echo "ğŸ” Backend Component Status:"
echo "- Firestore: $(docker-compose logs backend --tail=20 | grep -q "Firestore client initialized successfully" && echo "âœ… Connected" || echo "âŒ Failed")"
echo "- Vertex AI: $(docker-compose logs backend --tail=20 | grep -q "Vertex AI initialized successfully" && echo "âœ… Connected" || echo "âŒ Failed")"
echo "- Firebase Auth: $(docker-compose logs backend --tail=20 | grep -q "Firebase Admin SDK initialized successfully" && echo "âœ… Connected" || echo "âŒ Failed")"

echo ""
echo "ğŸš€ READY TO TEST!"
echo ""
echo "ğŸ“‹ Test Steps:"
echo "1. Open: http://localhost:4000"
echo "2. Sign in with any Google account"
echo "3. Go to Dashboard â†’ Create New Business Case"
echo "4. Fill out the form:"
echo "   - Project Title: 'Test AI Feature'"
echo "   - Problem Statement: 'We need better automation'"
echo "   - Relevant Links: (leave empty for now)"
echo "5. Click 'Initiate Case'"
echo ""
echo "âœ… Expected Result:"
echo "- No more 500 errors"
echo "- Case should be created successfully"
echo "- PRD should be generated by Vertex AI"
echo "- Should redirect to dashboard with new case listed"

echo ""
echo "ğŸ” If issues persist, check logs:"
echo "   docker-compose logs backend"
echo "   docker-compose logs frontend" 