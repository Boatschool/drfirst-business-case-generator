#!/bin/bash

echo "🧪 Testing Fixed Business Case Creation Flow..."
echo ""

echo "✅ Service Status:"
echo "- Backend Health: $(curl -s http://localhost:8000/health)"
echo "- Frontend: $(curl -s -o /dev/null -w "%{http_code}" http://localhost:4000)"

echo ""
echo "🔍 Backend Component Status:"
echo "- Firestore: $(docker-compose logs backend --tail=20 | grep -q "Firestore client initialized successfully" && echo "✅ Connected" || echo "❌ Failed")"
echo "- Vertex AI: $(docker-compose logs backend --tail=20 | grep -q "Vertex AI initialized successfully" && echo "✅ Connected" || echo "❌ Failed")"
echo "- Firebase Auth: $(docker-compose logs backend --tail=20 | grep -q "Firebase Admin SDK initialized successfully" && echo "✅ Connected" || echo "❌ Failed")"

echo ""
echo "🚀 READY TO TEST!"
echo ""
echo "📋 Test Steps:"
echo "1. Open: http://localhost:4000"
echo "2. Sign in with any Google account"
echo "3. Go to Dashboard → Create New Business Case"
echo "4. Fill out the form:"
echo "   - Project Title: 'Test AI Feature'"
echo "   - Problem Statement: 'We need better automation'"
echo "   - Relevant Links: (leave empty for now)"
echo "5. Click 'Initiate Case'"
echo ""
echo "✅ Expected Result:"
echo "- No more 500 errors"
echo "- Case should be created successfully"
echo "- PRD should be generated by Vertex AI"
echo "- Should redirect to dashboard with new case listed"

echo ""
echo "🔍 If issues persist, check logs:"
echo "   docker-compose logs backend"
echo "   docker-compose logs frontend" 